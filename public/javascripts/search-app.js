// Generated by CoffeeScript 1.8.0
(function() {
  var searchApp, searchQuery;

  searchQuery = "";

  $('window').ready(function() {
    if (navigator.platform !== "MacIntel") {
      $("html").niceScroll();
    }
    $('#search-field').on('focus', function(e) {
      $('#close-distraction-free-search-mode i').removeClass('display-none');
      $('#search-field').removeClass("animate-search-field restore-search-field");
      $('#div-blur-layer').removeClass("animate-blur-layer restore-blur-layer");
      $('#div-search-section').removeClass("animate-search-section restore-search-section");
      $('#search-field').addClass("animate-search-field");
      $('#div-blur-layer').addClass("animate-blur-layer");
      $('#div-search-section').addClass('animate-search-section');
    });
    $('#close-distraction-free-search-mode i').on('click', function(event) {
      $('.progress-indicator').toggleClass('display-none');
      $(this).toggleClass("display-none");
      $('#div-search-section').addClass('restore-search-section');
      $('#search-field').addClass("restore-search-field");
      $('#div-blur-layer').addClass("restore-blur-layer");
      $('#search-results-container').empty();
    });
    return $('#search-field').on('keyup', function(event) {
      if (event.keyCode === 13) {
        $('.progress-indicator').removeClass('display-none');
        console.log("search");
      }
    });
  });

  searchApp = angular.module('search-app', []);

  searchApp.controller('controller', [
    '$scope', '$http', function($scope, $http) {
      $scope.appData = {};
      $scope.appBehavior = {};
      $scope.appData.allSearchResultsData = [];
      $scope.appData.host = "http://tvserieswebapp.herokuapp.com";
      $scope.appData.progressIndicatorStatus = false;
      $scope.appBehavior.onKeyUp = function(event) {
        var url;
        if (event.keyCode === 13) {
          console.log($scope.appData.searchQuery);
          $scope.appData.progressIndicatorStatus = true;
          searchQuery = encodeURIComponent($scope.appData.searchQuery);
          url = "" + $scope.appData.host + "/series/seriesName/" + searchQuery;
          $http.get(url).success(function(data) {
            var currentSearchResultsData, series, _fn, _i, _len, _ref;
            $scope.appData.progressIndicatorStatus = false;
            if (data.seriesArray) {
              currentSearchResultsData = {
                "currentSearchResults": []
              };
              $scope.appData.allSearchResultsData.push(currentSearchResultsData);
              _ref = data.seriesArray;
              _fn = function(series, currentSearchResultsData) {
                $http.get(url).success(function(data) {
                  var banner, _j, _len1;
                  console.log(series.name);
                  for (_j = 0, _len1 = data.length; _j < _len1; _j++) {
                    banner = data[_j];
                    if (banner.type === "poster") {
                      currentSearchResultsData.currentSearchResults.push({
                        "name": series.name,
                        "id": series.id,
                        "bannerUrl": banner.url
                      });
                      break;
                    }
                  }
                });
              };
              for (_i = 0, _len = _ref.length; _i < _len; _i++) {
                series = _ref[_i];
                url = "" + $scope.appData.host + "/series/seriesId/" + series.id + "/banners";
                _fn(series, currentSearchResultsData);
              }
            }
          });
        }
      };
      $scope.appBehavior.viewSeries = function(event) {
        console.log("series clicked");
        return;
        return $scope.appBehavior.restAppData = function() {
          $scope.appData.allSearchResultsData = [];
          $scope.appData.searchQuery = "";
        };
      };
      return $scope.appBehavior.ifDataAvailable = function(data) {
        console.log(data);
        if (data && data.length() > 0) {
          return true;
        }
        return false;
      };
    }
  ]);

  searchApp.directive('currentSearchResultsDirective', function() {
    return function(scope, element, attrs) {
      $('#div-blur-layer').css("height", $('#div-search-section').css("height"));
    };
  });

}).call(this);


//# sourceMappingURL=search-app.js.map
